---
title: 信号处理理论基础
date: 2024-01-02
author: 王兵
summary: 数字信号处理概念、信号的数字化、数字信号处理的基本概念、信号的时频分析、信噪比概念
tag:
  - 数字信号处理
---

标签：[数字信号处理](../../_tags/数字信号处理)

## 1. 数字信号处理概念

### 1.1 **信号处理简介**

   - 信号处理的历史

     - 19 世纪开始有电信技术，早起主要是模拟信号，比如电话中声音信号的传输与放大
     - 二战期间，在雷达、通信系统中的技术发展显著，香农的工作也提供了理论基础
     - 1960 年代，随着数字计算机的发展，数字信号处理（DSP）兴起，快速傅里叶变换（FFT）算法提高了数字信号处理的效率
     - 21 世纪的近代，DSP 成为许多领域重要部分。

   - 模拟信号与数字信号的区别

     | 特性             | 模拟信号                       | 数字信号                                 |
     | ---------------- | ------------------------------ | ---------------------------------------- |
     | **表示形式**     | 连续，任何时间点都有值         | 离散，只在特定时间点上有值               |
     | **时间性质**     | 连续时间信号                   | 离散时间信号                             |
     | **值的范围**     | 可以取无限范围内的任何值       | 只能取有限数量的值                       |
     | **幅度量化**     | 幅度不进行量化                 | 幅度在采样时被量化为离散级别             |
     | **易受噪声影响** | 容易受到噪声影响，难以去除     | 对噪声有更强的抵抗力，可通过技术减少影响 |
     | **处理和传输**   | 需要模拟技术，复杂操作难以实现 | 适用数字技术，易于复杂操作实现           |
     | **存储**         | 存储相对复杂，容易随时间退化   | 易于存储，可长时间保存无损               |

   - 信号处理在通信、音频、图像处理中的应用

     - 通信：包括数据压缩、调制解调、错误检测与纠正等
     - 音频：声音的录制、编辑、合成和再现，音乐制作、降噪和音质增强等
     - 语音：语音识别、语音合成和语音编码等
     - 图像：图像增强、复原、压缩和特征提取等
     - 计算机视觉：人脸识别、物体检测等
     - 机器学习：数据预处理、特征提取和模式识别等
     - 医学成像：MRI、CT扫描等处理和解析成像数据等

### 1.2 **信号的数字化**

   - 采样理论（奈奎斯特定理）

     - 采样是将连续时间信号转换成离散时间信号的过程
     - 混叠（Aliasing）：如果采样频率太低，高频信号的部分可能会被错误解释为低频信号
     - 奈奎斯特定理：为了确保信号可以被完全重建，采样频率至少是最高频率成分的两倍
     - 一般实际应用中，通常会高于奈奎斯特频率的采样频率

   - 量化与编码

     - 量化和编码是将模拟信号转成数字信号的步骤
     - 量化：将采样值映射到预先定义的量化级别上。由于是连续映射到离散，会涉及到量化误差和精度。
     - 编码：将量化后的离散数值转换为可以在数字系统中存储和传输的形式。通常表示为二进制数，为了有效传输还会有数据压缩以及错误校正的步骤。

   - 采样频率与量化级别对信号的影响

     - 采样率指的是每秒中对信号进行采样的次数，通常以赫兹（Hz）为单位。它决定了信号的时间分辨率。
     - 量化级别指的是用于表示每个采样值的比特数，通常以比特（Bit）为单位。量化级别的选择决定了量化过程中可以表示的不同幅度级别的数量。

     |            | 优点                                 | 缺点                             |
     | ---------- | ------------------------------------ | -------------------------------- |
     | 高采样率   | 高时间分辨率，信号细节               | 需要更大存储空间和处理能力       |
     | 低采样率   | 减少存储空间和处理需求               | 低分辨率，丢失细节，混叠         |
     | 高量化级别 | 高幅度分辨率，低量化噪声，高动态范围 | 更多存储空间                     |
     | 低量化级别 | 减少存储空间                         | 低幅度分辨率，高噪声，低动态范围 |

### 1.3 **数字信号处理的基本概念**

   - 离散时间信号：

     - 离散时间信号是定义在时间点上的信号，常用序列比如 $x[n]$ 来表示。

   - 离散时间系统：

     - 离散时间系统是处理离散时间信号的系统，根据输入信号生成输出信号。

   - 离散时间系统分类：

     - 线性与非线性系统：线性系统满足叠加原理，非线性不满足。
     - 时不变系统与时变系统：时不变系统行为不随时间改变，时变系统不满足。
     - 因果系统与非因果系统：因果系统输入只取决于当前和过去的输入，非因果系统不满足。

   - Z 变换：

     - Z 变换是离散时间信号的拉普拉斯变换的等效形式，将离散时间信号 $x[n]$ 转换为复频域表示。数学表达式为：
       $$
       X(z) = \sum^{\infty}_{n=-\infty}x[n]z^{-n}
       $$
       其中 $z$ 是复数，形式为 $z = re^{j\omega}$

     - 用于离散时间系统的分析和设计，信号的时域和频域特性分析，如稳定性和频率响应分析。

     - 特别适用于描述和分析线性时不变系统（LTI）

   - 离散傅里叶变换（DFT）：

     - DFT 是傅里叶变换在离散时间信号上的应用，用于分析信号的频率内容。DFT 将离散时间信号转换为离散频域表示，其数学表达式为：
       $$
       X[k] = \sum^{N-1}_{n=0} x[n]e^{-j\frac{2\pi}{N}kn}
       $$
       其中，$N$ 是信号长度，$X[k]$ 是频域表示。

     - 用于信号的频谱分析，如分析信号的频率成分，滤波器设计等。快速傅里叶变换 FFT 是 DFT 的高效计算方法。适用于周期信号和非周期信号的频率分析。

   - 数字滤波器：

     + 数字滤波器用于从信号中提取所需要的信息或者去除不需要的部分。

   - 数字滤波器的规格：

     - 滤波器类型：低通、高通、带通、带阻
     - 频率规格：截止频率、带宽、阻带、通带频率等。
     - 幅度规格：通带波纹，阻带衰减。
     - 滤波器阶数：决定了复杂度和性能

   - 滤波器设计方法：

     - IIR（无限冲击响应）滤波器：如巴特沃斯、切比雪夫、椭圆等，通常具有较低的阶数，但可能不是线性相位的，需要考虑稳定性。
     - FIR（有限冲击响应）滤波器：通常使用窗函数法或最小二乘法设计，通常是线性相位的，易于实现，但可能需要较高阶数。

   - 滤波器实现：

     - 软件实现：比如 Matlab、Python 实现滤波器算法
     - 硬件实现：比如数字信号处理器 DSP 或可编程门阵列（FPGA）

   - 性能验证：

     - 频率响应分析：确设计的滤波器满足频率规格
     - 时域分析：检查滤波器的阶跃响应和冲击响应
     - 稳定性测试：特别是对 IIR 滤波器很重要

## 2.信号的时频分析

### 2.1 **时域分析**

   - 信号的时域特性：
     - 幅度相关：比如信号幅度的峰值、幅度平均值、幅度的均方根值（能量水平）
     - 相位相关：描述信号波形相对于参考信号的位移或延迟。
     - 频率相关：基频，周期信号重复的频率，谐波频率：周期信号中频率的整数倍部分。
     - 周期性：是否有固定重复周期
     - 对称性：是否关于某一点或某一条轴对称。
     - 能量信号：总能量有限的信号，比如脉冲信号
     - 功率信号：平均功率有限，但总能量可能无限的信号，比如周期信号。
     - 稳定性：表示信号随时间变化的稳定程度
     - 波形特性：如锯齿波、方波、三角波等。
   - 信号波形与波形参数：
     - 波形：描述信号在时间轴上的形状，如正弦波、方波、锯齿波等
     - 振幅：信号在时域中平均值到最大值或最小值之间的差异。
     - 峰·峰值：波形信号中最高点和最低点之间的差值。
     - 周期：重复的时间间隔。
     - 频率：单位时间内重复的次数。
     - 相位：相对于其标准形式的位移。
     - 有效值（RMS）：信号的电能大小的度量。
   - 时域分析的应用实例：
     - 音频信号处理：用于波形剪辑、混音、动态范围压缩。通过波形还可以检测失真和过载。
     - 通信系统：调制信号的时域特性，如 AM（幅度调制）、FM（频率调制）。
     - 雷达和声呐信号：通过分析回波的时延和振幅来检测和定位物体。
     - 医学信号处理：心电图（ECG）脑电图（EEG）信号分析，用于诊断和监测。
     - 振动分析：机械系统的故障诊断，分析旋转机械的不平衡或故障。
     - 电力系统分析：监测电压波动和暂态现象等。

### 2.2 **频域分析**

   - 频域分析把信号从其原始形式转换为表示信号频率成分的形式。频域中，信号被描述各种频率成分的组合，每个成分都有幅度和相位。

   - 频域的基本概念：

     - 频率：表示信号周期变化快慢（单位：Hz）
     - 周期：信号重复自身的时间长度。
     - 幅度：特定频率成分的强度或能量。
     - 相位：特定频率成分相对标准参考点的时移。

   - 傅里叶级数与傅里叶变换：

     - 傅里叶分析是将信号分解成频域的数学工具。

     - 傅里叶级数：对周期性信号，分解为一系列的正弦和余弦波
       $$
       f(t) = a_0 + \sum_{n=1}^{\infty} \left[ a_n \cos(n \omega_0 t) + b_n \sin(n \omega_0 t) \right]
       $$

     - 傅里叶变换：对非周期信号，将其转换为连续的频谱
       $$
       F(\omega) = \int_{-\infty}^{\infty} f(t) e^{-j\omega t} \, dt
       $$

   - 拉普拉斯变换

     - 用于分析线性时不变（LTI）系统，其数学表达式为：
       $$
       F(s) = \int_{0}^{\infty} f(t) e^{-st} dt
       $$
       其中：s 是复数变量，$s = \sigma + j\omega$

     - 它可以处理信号的增长、衰减和震荡等特性，比傅里叶变换更具一般性，考虑了信号的全部历史，傅里叶变换则通常用于周期性或非周期性但不增长的函数，主要关注信号的稳态行为。

     - 傅里叶变换可以看做是拉普拉斯变换的特例，当拉普拉斯变换中的 $\sigma = 0$ 时，等价于傅里叶变换。

   - 频谱分析与频谱图：

     - 频谱分析是分析信号的频率成分的过程。
     - 频谱图显示信号的各个频率成分的幅度、有事包括相位。X 轴代表频率，Y  轴代表幅度。
     - 通过频谱分析，可以提取出有关信号的重要信息，在时域中可能不是那么明显。

### 2.3 **时频分析方法**

   - 时频分析方法是指能够同时提供信号时域和频率信息的分析技术。

   - 短时傅里叶变换（STFT）

     - 原理：STFT 将信号分割成较短的时间片段，然后对每个片段进行傅里叶变换来工作。

     - 公式：
       $$
       STFT\{x(t)\}(\tau, \omega) = \int_{-\infty}^{\infty} x(t) w(t-\tau) e^{-j\omega t} dt
       $$
       其中，$\omega(t)$ 是时间窗函数，$\tau$ 是时间变量，$\omega$ 是频率。

     - 应用：比如语音分析，雷达系统和通信系统中信号的时间变化特性。

   - 小波变换

     - 原理：通过使用一系列「小波」对母函数进行信号分析，这些母函数可以被拉伸（用于分析低频成分）和压缩（用于分析高频成分）。

     - 公式：
       $$
       W_x(a, b) = \frac{1}{\sqrt{|a|}} \int_{-\infty}^{\infty} x(t) \psi^*\left(\frac{t-b}{a}\right) dt
       $$
       其中，$\psi(t)$ 是小波函数，$a$是尺度参数，$b$ 是位置参数。

     - 应用：比如图像处理，图像压缩和特征提取。在生物医学信号中处理比如心电图 ECG 类的复杂信号。

   - 其他时频域分析方法：

     + **Wigner-Ville 分布, WVD**：一种高分辨率的时频表示方法，提供信号的瞬时频率信息，但可能会产生交叉项，导致解释困难。
     + **Choi-Williams 分布**：类似 WVD，但通过应用一个核函数来减少交叉项的影响。
     + **Gabor 变换**：STFT 的一种变体，使用固定窗口宽度对信号进行分析。
     + **Hilbert-Huang 变换（HHT）**：特别适用于非线性和非平稳信号的分析，首先使用经验模态分解（EMD）将信号分解为一组本征模态函数（IMF）然后对每个 IMF 进行 Hilbert 谱分析。
     + **S 变换**：结合了 STFT 和小波变换的特点，提供了频率依赖的分辨率。是对信号进行局部化频率分析的工具。

## 3. 信噪比

### 3.1 **信噪比的定义与重要性**

   - 信噪比的数学定义
     - 信噪比是衡量信号强度相对于背景噪音强度的度量。通常以分贝（dB）为单位表示，以下是 SNR（Signal-to-Noise Ratio）公式：

     - 数学定义：
       $$
       SNR(dB) = 10 \log_{10}(\frac{P_{signal}}{P_{noise}})
       $$
       其中 $P_{signal}$ 是信号的功率，$P_{noise}$ 是噪声的功率。

   - 信号质量评估中的信噪比

     - 高信噪比：意味着信号中有用信息远大于干扰噪声，通常与更好的信号质量和更清晰的接受相关。
     - 低信噪比：表示噪声水平高，会让信号不清晰或难以解释。信噪比过低会引起信号失真，极端情况下，可能会导致信号完全被噪声掩盖。

   - 信噪比与系统性能

     - 高信噪比在通信系统、音频系统、图像和视频系统、测量和仪器设备等系统应用性能中都非常重要。

   - 测量信噪比的方法

     - 直接测量：通过测量整个系统的输出，然后再相同条件下仅测量噪声的方法计算信噪比。
     - 间接测量：分别测量信号和噪声的功率或振幅水平，然后用 SNR 公式计算。

### 3.2 **提高信噪比的策略**

   - 信号增强技术
     - 信号放大器：使用高质量的信号放大器，同时尽量不增加额外的噪声。
     - 预处理滤波：在信号处理早期使用滤波器提取信号重要成分，削弱不相关的频率成分。
     - 自适应滤波：使用自适应滤波技术，根据信号特征动态调整滤波器参数。
   - 噪声减少方法
     - 源头控制：在噪声源头采取屏蔽、隔离等措施。
     - 数字降噪：在数字信号处理中应用各种算法：比如谱减法、小波降噪等。
     - 空间滤波器：对于多通道系统，如阵列麦克风或天线，使用波束形成等技术空间上抑制噪声。
   - 信号重建与恢复
     - 错误更正编码：如卷积码或涡轮码，以在接收端重建原始信号。
     - 数据插值与重采样：对丢失或损坏的型号部分进行插值或重采样。
     - 信号重建：应用数学模型和算法，如压缩感知、稀疏表示等，以从不完整或损坏的数据中恢复信号。
